<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Academic Leadership Toolkit — Shunya Publications</title>
<meta name="description" content="An interactive, offline-ready toolkit for academic leaders: NAAC/NIRF readiness, KPI dashboards, governance, IQAC evidence, OBE matrices, projects, risks, budgets, meetings, and more.">
<link rel="canonical" href="/leadership.html" />
<meta name="theme-color" content="#1565ff">

<!-- Favicons (aligned with index.html) -->
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Shunya">
<link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png">
<link rel="icon" type="image/png" sizes="192x192" href="/web-app-manifest-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/web-app-manifest-512x512.png">
<link rel="manifest" href="/site.webmanifest?v=2">

<!-- Social cards -->
<meta property="og:type" content="website" />
<meta property="og:url" content="https://www.shunyapublications.com/leadership.html" />
<meta property="og:title" content="Academic Leadership Toolkit — Shunya Publications" />
<meta property="og:description" content="A hands-on toolkit for higher-education leaders — plan strategy, prepare NAAC/NIRF, track KPIs, risks, budgets, IQAC artifacts, and more." />
<meta property="og:image" content="https://www.shunyapublications.com/Logosh.png" />
<meta property="og:image:secure_url" content="https://www.shunyapublications.com/Logosh.png" />
<meta property="og:image:type" content="image/png" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta name="twitter:card" content="summary_large_image" />

<style>
/* ========= Shunya Design System (aligned with index.html) ========= */
:root{
  --bg:#ffffff;
  --bg-1:#fff9f1; --bg-2:#f3f9ff; --bg-3:#eef9f5;
  --text:#142036; --muted:#5a6b88;
  --line:#e6ecf5; --line-strong:#cfd8e6;
  --brand:#1565ff; --brand-2:#ff7a3d; --brand-3:#15a085; --accent:#7d4dff; --gold:#f6b73c;
  --shadow:0 12px 30px rgba(21,101,255,.10);
  --shadow-soft:0 10px 24px rgba(20, 32, 54, .10);
  --ring: 0 0 0 4px rgba(21,101,255,.16);
  --font: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
  --fs-hero: clamp(2.0rem, 3.2vw, 2.6rem);
  --fs-h2: clamp(1.4rem, 1.8vw, 1.8rem);
  --fs-h3: 1.06rem;
  --radius: 16px;
  --radius-lg: 20px;
}
*{box-sizing:border-box}
html{scroll-behavior:smooth}
body{
  margin:0; font-family:var(--font); color:var(--text); background: var(--bg);
  background:
    radial-gradient(1100px 620px at 10% -10%, var(--bg-1) 0%, #fff 60%),
    radial-gradient(1200px 720px at 110% 110%, var(--bg-2) 0%, #fff 55%),
    radial-gradient(1000px 650px at -10% 120%, var(--bg-3) 0%, #fff 50%);
}
a{color:var(--brand);text-decoration:none}
a:hover{text-decoration:underline}
.container{max-width:1180px;margin:auto;padding:0 20px}
.section{padding:56px 0; border-top:1px solid var(--line)}
.section:first-of-type{border-top:none}
.stack{display:flex;flex-direction:column;gap:14px}

/* Components */
.card{background:#fff;border:1px solid var(--line);border-radius:var(--radius);padding:16px;box-shadow:var(--shadow-soft)}
.card-lg{padding:20px;border-radius:var(--radius-lg)}
.eyebrow{font-size:.8rem; letter-spacing:.08em; text-transform:uppercase; color:var(--muted)}
.lead{color:#2a3b5c;opacity:.95}
.notice{background:linear-gradient(180deg,#f7fbff,#fff);border:1px dashed #cfe0ff;padding:12px;border-radius:12px}
small.muted{color:var(--muted)}
.badge-soft{display:inline-block;padding:4px 8px;border-radius:999px;border:1px solid var(--line);font-size:.8rem;background:#fff}

/* Buttons */
.btn{display:inline-flex;align-items:center;gap:8px;padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:linear-gradient(180deg,#fff,#f6fbff);box-shadow:var(--shadow);color:var(--text);font-weight:600;cursor:pointer}
.btn:hover{box-shadow:var(--ring)}
.btn.primary{background:linear-gradient(180deg,#f7fbff,#eaf2ff); border-color:#dbe7ff}
.btn.danger{background:linear-gradient(180deg,#fff5f5,#ffecec); border-color:#ffd6d6; color:#8b1e1e}

/* Form / Tables */
label{font-weight:700}
input[type="text"],input[type="number"],input[type="date"],input[type="url"],input[type="file"],textarea,select{
  width:100%; padding:10px 12px; border:1px solid var(--line-strong); border-radius:12px; font:inherit; background:#fff
}
textarea{min-height:110px; resize:vertical}
.table{width:100%; border-collapse:separate; border-spacing:0 8px}
.table th{font-size:.9rem; color:#374a6b; text-align:left; padding:6px 8px}
.table td{background:#fff; border:1px solid var(--line); padding:8px; border-radius:10px}

/* Grid / Rows */
.grid{display:grid;gap:16px}
.grid.cols-4{grid-template-columns:repeat(4,1fr)}
.grid.cols-3{grid-template-columns:repeat(3,1fr)}
.grid.cols-2{grid-template-columns:repeat(2,1fr)}
@media(max-width:1000px){ .grid.cols-4,.grid.cols-3{grid-template-columns:repeat(2,1fr)} }
@media(max-width:700px){ .grid.cols-4,.grid.cols-3,.grid.cols-2{grid-template-columns:1fr} }

.row{display:flex;flex-wrap:wrap;gap:12px}
.w-25{flex:1 1 260px}
.w-33{flex:1 1 320px}
.w-50{flex:1 1 480px}
.w-66{flex:2 1 640px}
.w-75{flex:3 1 780px}
.w-100{flex:1 1 100%}

/* KPI */
.kpi{padding:12px;border:1px solid var(--line);border-radius:14px;background:#fff;display:flex;flex-direction:column;gap:8px}
.kpi .row{display:flex;gap:10px;align-items:center}
.kpi b{font-size:1.12rem}
.badge{display:inline-block;padding:2px 8px;border-radius:999px;border:1px solid var(--line);font-size:.8rem;background:#fff}
.status-ok{background:#e9fff4;border-color:#c8f0dd;color:#0d6a4b}
.status-warn{background:#fff8e6;border-color:#ffe4a8;color:#856404}
.status-risk{background:#ffefef;border-color:#ffd3d3;color:#842029}

/* Sticky Global Nav (brand + site menu) */
.nav{position:sticky;top:0;z-index:60;background:rgba(255,255,255,.92);backdrop-filter:blur(10px);border-bottom:1px solid var(--line)}
.nav .inner{display:flex;align-items:center;justify-content:space-between;padding:10px 0}
.brand{display:flex;gap:12px;align-items:center}
.brand img{height:42px;width:42px;border-radius:10px;box-shadow:var(--shadow-soft)}
.brand span{font-weight:800}
.menu a{margin-left:18px;color:var(--muted);font-weight:600}
.menu a:hover{color:var(--text)}
.menu a[aria-current="page"]{color:var(--text);text-decoration:underline}

.mono{font-family:ui-monospace,Menlo,Consolas,monospace}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){ html{scroll-behavior:auto} }
</style>
</head>
<body>

<!-- Global Site Nav (same as index.html) -->
<nav class="nav" aria-label="Global">
  <div class="container inner">
    <div class="brand">
      <img src="/images/Logosh.png" alt="Shunya Publications Logo" />
      <span>Shunya Publications</span>
    </div>
    <div class="menu" role="navigation">
      <a href="/index.html">Home</a>
      <a href="/books.html">Books</a>
      <a href="/journal.html">Journals</a>
      <a href="/services.html">Services</a>
      <a href="/research.html">Research</a>
      <a href="/leadership.html" aria-current="page">Academic Leadership</a>
    </div>
  </div>
</nav>

<!-- START HERE (Left 3/4 card + Right 1/4 image/status column) -->
<header class="section" id="start">
  <div class="container">
    <div class="stack">
      <div class="row">
        <!-- LEFT: 3/4 width -->
        <div class="w-75">
          <div class="card card-lg">
            <p class="eyebrow">Start Here</p>
            <div style="display:flex;align-items:center;gap:10px;flex-wrap:wrap">
              <h1 style="margin:.2rem 0; font-size:var(--fs-hero)">Academic Leadership — Interactive Tools</h1>
              <span class="badge-soft">v3.4</span>
            </div>
            <p class="lead">
              This page is a working toolkit for VCs, Registrars, Deans, HoDs, IQAC teams, and faculty leaders.
              It autosaves locally (offline-friendly) and lets you export/import your work for sharing and backup.
              Every section includes a plain-English description, best-practice tips, and quick actions.
            </p>

            <!-- Guide + Global Actions -->
            <div class="notice">
              <b>Leadership Guide (PDF)</b><br>
              Use this guide alongside the interactive page. Every section below mirrors a card here and explains
              what to enter, why it matters, and what “good” looks like.
              <div class="row" style="margin-top:10px;gap:8px">
                <input id="pdfLink" type="url" placeholder="/leadership.pdf" value="/leadership.pdf"
                       style="min-width:240px; flex:1; padding:10px 12px; border-radius:10px; border:1px solid var(--line-strong)" />
                <a class="btn primary" id="open-pdf" target="_blank" rel="noopener" href="/leadership.pdf">Open PDF</a>
                <button class="btn" id="global-export-json">Export JSON</button>
                <button class="btn" id="global-import-json">Import JSON</button>
                <button class="btn" id="global-export-csv">Export CSV (All)</button>
                <button class="btn danger" id="global-reset">Reset All</button>
              </div>
            </div>

            <!-- Org Identity + Uploads -->
            <div class="card" style="margin-top:12px">
              <b>Your Organization Identity for Outputs</b>
              <p class="lead" style="margin:.4rem 0">
                Upload your <b>logo</b> and set the <b>organization name</b> to brand printable outputs like Minutes and NAAC/NIRF tables.
                You can also upload an <b>Institution Cover Image</b> that shows on the right panel (1/4 width) for a personalized look.
                All files stay in your browser only.
              </p>
              <div class="row">
                <div class="w-50">
                  <label>Organization / Institution Name</label>
                  <input id="orgName" type="text" placeholder="e.g., Shunya Publications / Your University Name" />
                </div>
                <div class="w-50">
                  <label>Upload Logo (PNG/JPG/SVG)</label>
                  <input id="orgLogo" type="file" accept=".png,.jpg,.jpeg,.svg" />
                </div>
                <div class="w-50">
                  <label>Institution Cover Image (shows at right)</label>
                  <input id="instImage" type="file" accept=".png,.jpg,.jpeg,.svg" />
                </div>
                <div class="w-50">
                  <div class="row" style="align-items:center;gap:10px">
                    <span class="badge-soft">Autosave: On <span class="mono">(localStorage)</span></span>
                    <span class="badge-soft">Language: English</span>
                    <span class="badge-soft">Version: v3.4</span>
                    <span class="badge-soft">Last Save: <span id="lastSave">—</span></span>
                  </div>
                </div>
              </div>
              <small class="muted">Logos and images are kept only in this browser. To clear, use <b>Reset All</b> above.</small>
            </div>

            <!-- Jump buttons -->
            <div class="row" style="margin-top:12px">
              <a class="btn" href="#dashboard">Set KPIs</a>
              <a class="btn" href="#planning">Plan 5 Years</a>
              <a class="btn" href="#accreditation">NAAC/NIRF</a>
              <a class="btn" href="#governance">Governance</a>
              <a class="btn" href="#iqac">Evidence Locker</a>
              <a class="btn" href="#projects">Projects</a>
              <a class="btn" href="#obe">OBE</a>
              <a class="btn" href="#research">Research</a>
              <a class="btn" href="#consultancy">Consultancy/MoUs</a>
              <a class="btn" href="#faculty">Faculty Plan</a>
              <a class="btn" href="#students">Student Success</a>
              <a class="btn" href="#risk">Risk</a>
              <a class="btn" href="#budget">Budget</a>
              <a class="btn" href="#meetings">Minutes</a>
              <a class="btn" href="#comms">Communication</a>
              <a class="btn" href="#actions">Action Tracker</a>
            </div>
          </div>
        </div>

        <!-- RIGHT: 1/4 width — institution image + status -->
        <div class="w-25">
          <figure class="card" style="text-align:center">
            <img id="instHeroPreview" src="" alt="Institution cover"
                 style="max-width:100%; height:auto; border:1px solid var(--line); border-radius:12px; display:none" />
            <figcaption class="muted" id="instHeroCaption" style="margin-top:6px">
              Upload an institution cover image (right here) using the field in the left card.
            </figcaption>
          </figure>
          <div class="kpi" style="margin-top:12px">
            <div><b>Status</b></div>
            <div>Autosave: <span class="mono">localStorage</span></div>
            <div>Last Save: <span id="lastSave2">—</span></div>
            <div>Toolkit: v3.4</div>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

<!-- DASHBOARD -->
<section id="dashboard" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Overview</p>
        <h2 style="font-size:var(--fs-h2);margin:0 0 6px">Leadership Dashboard (Snapshot)</h2>
        <p class="lead">
          Weekly “single-pane” view. Each tile is a live KPI you can rename, edit, and mark:
          <b>OK</b> (on/above target), <b>Watch</b> (near slip), <b>Risk</b> (off-target). Use this for executive huddles; the detail sits in the NAAC/NIRF, Projects, OBE, and other sections.
        </p>
      </div>

      <div class="grid cols-4" id="kpiGrid"></div>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn" id="addKPI">+ Add KPI</button>
        <button class="btn primary" data-export="kpi">Export CSV</button>
        <button class="btn" data-print="kpi">Print</button>
      </div>
      <small class="muted">Common KPIs: Research Output, Patents, Consultancy ₹, Placement %, Median CTC, NAAC Grade, NIRF Rank Band, Curriculum Revisions, OBE Mapping %, FDPs/Faculty, Internships %, NPTEL/MOOC Credits, IPR filings.</small>
    </div>
  </div>
</section>

<!-- STRATEGIC PLANNING -->
<section id="planning" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Strategy</p>
        <h2 style="margin:0 0 6px">Strategic Planning Canvas (5-Year)</h2>
        <p class="lead">
          Concise, do-first planning canvas aligned with NEP 2020 and UGC/AICTE expectations:
          <b>Vision/Mission → Goals → KPIs → Initiatives → Policy Alignment</b>.
        </p>
      </div>

      <div class="row">
        <div class="w-50">
          <label>Vision</label>
          <textarea id="sp-vision" placeholder="Future-facing north star"></textarea>
        </div>
        <div class="w-50">
          <label>Mission</label>
          <textarea id="sp-mission" placeholder="What we do daily to serve that vision"></textarea>
        </div>
        <div class="w-33">
          <label>Goals (3–5)</label>
          <textarea id="sp-goals" placeholder="Goal 1…&#10;Goal 2…&#10;Goal 3…"></textarea>
        </div>
        <div class="w-33">
          <label>KPIs & Milestones</label>
          <textarea id="sp-kpis" placeholder="Metric → Baseline → Year targets"></textarea>
        </div>
        <div class="w-33">
          <label>Flagship Initiatives & Owners</label>
          <textarea id="sp-initiatives" placeholder="Initiative — Owner — Start — End"></textarea>
        </div>
      </div>
      <div class="row">
        <div class="w-66">
          <label>NEP/UGC/AICTE/NAAC/NIRF Alignment</label>
          <textarea id="sp-alignment" placeholder="Map each goal/initiative to policy/compliance expectations"></textarea>
        </div>
        <div class="w-33">
          <label>Key Policies</label>
          <textarea id="sp-policies" placeholder="Research & IPR, Consultancy, DEI, Academic Integrity, Data Governance…"></textarea>
        </div>
      </div>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn primary" data-export="sp">Export JSON</button>
        <button class="btn" data-print="sp">Print</button>
      </div>
    </div>
  </div>
</section>

<!-- ACCREDITATION -->
<section id="accreditation" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Quality & Rankings</p>
        <h2 style="margin:0 0 6px">NAAC Readiness & NIRF Indicators</h2>
        <p class="lead">
          NAAC Evidence Checklist = curated, current, citable artifacts by criterion.
          NIRF Input Sheet = indicators with traceable sources. Keep an AICTE/UGC Compliance Calendar for EOA, affiliations, audits.
        </p>
      </div>

      <div class="card">
        <h3 style="margin:0 0 6px">NAAC Criteria Evidence Checklist</h3>
        <table class="table" id="naacTable">
          <thead>
            <tr>
              <th>Criterion</th><th>Artifact / Evidence</th><th>Owner</th><th>Link/Path</th><th>Status</th><th>Notes</th><th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <div class="row" style="gap:8px; flex-wrap:wrap">
          <button class="btn" id="addNaac">+ Add Evidence</button>
          <button class="btn primary" data-export="naac">Export CSV</button>
          <button class="btn" data-print="naac">Print</button>
        </div>
        <small class="muted">Criteria: (1) Curricular Aspects, (2) Teaching-Learning & Evaluation, (3) Research/Innovations/Extension, (4) Infrastructure & Learning Resources, (5) Student Support & Progression, (6) Governance/Leadership/IQAC, (7) Institutional Values & Best Practices.</small>
      </div>

      <div class="card">
        <h3 style="margin:0 0 6px">NIRF Input Sheet (Core)</h3>
        <table class="table" id="nirfTable">
          <thead>
            <tr>
              <th>Category</th><th>Indicator</th><th>Value</th><th>Year</th><th>Source/Evidence</th><th>Notes</th><th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <div class="row" style="gap:8px; flex-wrap:wrap">
          <button class="btn" id="addNirf">+ Add Indicator</button>
          <button class="btn primary" data-export="nirf">Export CSV</button>
          <button class="btn" data-print="nirf">Print</button>
        </div>
        <small class="muted">Common: Teaching & Learning, Research & Professional Practice, Graduation Outcomes, Outreach & Inclusivity, Peer Perception.</small>
      </div>

      <div class="card">
        <h3 style="margin:0 0 6px">AICTE/UGC Compliance Calendar</h3>
        <table class="table" id="compTable">
          <thead>
            <tr>
              <th>Item</th><th>Body</th><th>Date/Window</th><th>Owner</th><th>Status</th><th>Notes</th><th></th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
        <div class="row" style="gap:8px; flex-wrap:wrap">
          <button class="btn" id="addComp">+ Add Item</button>
          <button class="btn primary" data-export="comp">Export CSV</button>
          <button class="btn" data-print="comp">Print</button>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- GOVERNANCE -->
<section id="governance" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Governance</p>
        <h2 style="margin:0 0 6px">Governance Matrix (Bodies & Decisions)</h2>
        <p class="lead">List Academic Council, BoS/BoG, Finance Committee, Research Committee, Ethics Committee, IQAC, etc., with cadence, quorum, decisions, and evidence links (minutes/office orders).</p>
      </div>
      <table class="table" id="govTable">
        <thead>
          <tr>
            <th>Body</th><th>Cadence</th><th>Quorum</th><th>Decision/Resolution</th><th>Evidence (Minutes/Order)</th><th>Owner</th><th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn" id="addGov">+ Add Row</button>
        <button class="btn primary" data-export="gov">Export CSV</button>
        <button class="btn" data-print="gov">Print</button>
      </div>
    </div>
  </div>
</section>

<!-- IQAC -->
<section id="iqac" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">IQAC</p>
        <h2 style="margin:0 0 6px">Evidence Locker (Artifacts Manifest)</h2>
        <p class="lead">Manifest of policies, minutes, AARs, CO-PO matrices, syllabi, result analyses, FDP proofs, outreach, MoUs, consultancy orders, IPR filings, accreditation letters, etc., with versions/dates.</p>
      </div>
      <table class="table" id="iqacTable">
        <thead>
          <tr>
            <th>Artifact</th><th>Type</th><th>Program/Dept</th><th>Link/Path</th><th>Owner</th><th>Version/Date</th><th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn" id="addIqac">+ Add Artifact</button>
        <button class="btn primary" data-export="iqac">Export CSV</button>
        <button class="btn" data-print="iqac">Print</button>
      </div>
    </div>
  </div>
</section>

<!-- PROJECTS -->
<section id="projects" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Projects</p>
        <h2 style="margin:0 0 6px">Project Planner (Light Gantt)</h2>
        <p class="lead">Portfolio of flagship initiatives with owners and milestones. Tie each project to a strategic goal and NAAC/NIRF levers.</p>
      </div>
      <table class="table" id="projTable">
        <thead>
          <tr>
            <th>Project</th><th>Owner</th><th>Start</th><th>End</th><th>Status</th><th>Milestones</th><th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn" id="addProj">+ Add Project</button>
        <button class="btn primary" data-export="proj">Export CSV</button>
        <button class="btn" data-print="proj">Print</button>
      </div>
    </div>
  </div>
</section>

<!-- OBE -->
<section id="obe" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Teaching-Learning</p>
        <h2 style="margin:0 0 6px">OBE Course Matrix (PO/CO Mapping)</h2>
        <p class="lead">Capture course-PO and course-CO mappings; record assessment split and attach evidence (syllabi/CO-PO matrices). Feed CO attainment into PO attainment and curriculum revision.</p>
      </div>
      <table class="table" id="obeTable">
        <thead>
          <tr>
            <th>Course</th><th>POs (e.g., PO1, PO2)</th><th>COs</th><th>Assessment Split (%)</th><th>Evidence (Syllabus/CO-PO)</th><th>Owner</th><th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn" id="addObe">+ Add Course</button>
        <button class="btn primary" data-export="obe">Export CSV</button>
        <button class="btn" data-print="obe">Print</button>
      </div>
    </div>
  </div>
</section>

<!-- RESEARCH -->
<section id="research" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Research</p>
        <h2 style="margin:0 0 6px">Research & Innovation Tracker</h2>
        <p class="lead">Track publications (SCI/Scopus/UGC-CARE), patents, consultancy (₹), grants, prototypes, start-ups/incubation, outreach with evidence links. Capture impact (citations, policy, societal outcomes).</p>
      </div>
      <table class="table" id="rsTable">
        <thead>
          <tr>
            <th>Type</th><th>Title/Topic</th><th>Venue/Office</th><th>Value/Index</th><th>Year</th><th>Evidence</th><th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn" id="addRs">+ Add Entry</button>
        <button class="btn primary" data-export="rs">Export CSV</button>
        <button class="btn" data-print="rs">Print</button>
      </div>
    </div>
  </div>
</section>

<!-- CONSULTANCY & MoUs -->
<section id="consultancy" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Industry</p>
        <h2 style="margin:0 0 6px">Consultancy & MoU Tracker</h2>
        <p class="lead">Maintain MoUs/consultancy pipeline: partner, scope/value, start/end, evidence. Tag strategic partnerships for branding and placements.</p>
      </div>
      <table class="table" id="mouTable">
        <thead>
          <tr>
            <th>Type</th><th>Partner/Client</th><th>Value/Scope</th><th>Start</th><th>End</th><th>Evidence/Link</th><th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn" id="addMou">+ Add</button>
        <button class="btn primary" data-export="mou">Export CSV</button>
        <button class="btn" data-print="mou">Print</button>
      </div>
    </div>
  </div>
</section>

<!-- FACULTY -->
<section id="faculty" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Faculty</p>
        <h2 style="margin:0 0 6px">Faculty Workload & FDP Plan</h2>
        <p class="lead">Balance teaching, research, and admin hours; plan FDPs aligned to gaps and accreditation needs. Pair with OBE & Research trackers to spot load/impact imbalances.</p>
      </div>
      <table class="table" id="fwTable">
        <thead>
          <tr>
            <th>Name</th><th>Teaching (Hrs/Wk)</th><th>Research (Hrs/Wk)</th><th>Admin (Hrs/Wk)</th><th>FDP/Training</th><th>Notes</th><th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn" id="addFw">+ Add Faculty</button>
        <button class="btn primary" data-export="fw">Export CSV</button>
        <button class="btn" data-print="fw">Print</button>
      </div>
    </div>
  </div>
</section>

<!-- STUDENT SUCCESS -->
<section id="students" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Students</p>
        <h2 style="margin:0 0 6px">Student Success Inputs</h2>
        <p class="lead">Program-wise placement %, median CTC, internship %, MOOC/NPTEL credits, notes. Feeds NIRF GO & OI; calibrate training and curriculum reforms.</p>
      </div>
      <table class="table" id="stuTable">
        <thead>
          <tr>
            <th>Program</th><th>Placement %</th><th>Median CTC</th><th>Internship %</th><th>MOOC/NPTEL Credits</th><th>Notes</th><th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn" id="addStu">+ Add Program</button>
        <button class="btn primary" data-export="stu">Export CSV</button>
        <button class="btn" data-print="stu">Print</button>
      </div>
    </div>
  </div>
</section>

<!-- RISK -->
<section id="risk" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Risks</p>
        <h2 style="margin:0 0 6px">Risk Register</h2>
        <p class="lead">Record risks with likelihood, impact, mitigation, owner, and status. Review quarterly in IQAC; escalate reds to BoG with time-bound actions.</p>
      </div>
      <table class="table" id="riskTable">
        <thead>
          <tr>
            <th>Risk</th><th>Likelihood</th><th>Impact</th><th>Mitigation</th><th>Owner</th><th>Status</th><th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn" id="addRisk">+ Add Risk</button>
        <button class="btn primary" data-export="risk">Export CSV</button>
        <button class="btn" data-print="risk">Print</button>
      </div>
    </div>
  </div>
</section>

<!-- BUDGET -->
<section id="budget" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Finance</p>
        <h2 style="margin:0 0 6px">Budget Planner (Capex/Opex)</h2>
        <p class="lead">Single-view of institutional spending. Connect line items to Projects & KPIs to show value flow.</p>
      </div>
      <table class="table" id="budTable">
        <thead>
          <tr>
            <th>Item</th><th>Type</th><th>Amount (₹)</th><th>Funding Source</th><th>Year</th><th>Owner</th><th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn" id="addBud">+ Add Item</button>
        <button class="btn primary" data-export="bud">Export CSV</button>
        <button class="btn" data-print="bud">Print</button>
      </div>
    </div>
  </div>
</section>

<!-- MEETINGS -->
<section id="meetings" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Meetings</p>
        <h2 style="margin:0 0 6px">Minutes Generator</h2>
        <p class="lead">Standardize minutes for IQAC, AC, BoS, and cross-functional reviews. Your uploaded logo + organization name appear on printouts.</p>
      </div>
      <div class="row">
        <div class="w-33">
          <label>Meeting Title</label>
          <input id="mt-title" type="text" placeholder="e.g., IQAC Review (Q2)">
          <label>Date</label>
          <input id="mt-date" type="date">
          <label>Attendees</label>
          <input id="mt-att" type="text" placeholder="Names/roles">
        </div>
        <div class="w-66">
          <label>Agenda</label>
          <textarea id="mt-agenda" placeholder="Item 1…&#10;Item 2…"></textarea>
          <label>Decisions</label>
          <textarea id="mt-decisions" placeholder="Decision — Rationale — Vote (if any)"></textarea>
          <label>Action Items</label>
          <textarea id="mt-actions" placeholder="Task — Owner — Due date"></textarea>
        </div>
      </div>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn primary" data-export="mt">Export Minutes (TXT)</button>
        <button class="btn" data-print="mt">Print</button>
      </div>
    </div>
  </div>
</section>

<!-- COMMUNICATION -->
<section id="comms" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Change</p>
        <h2 style="margin:0 0 6px">Communication Plan</h2>
        <p class="lead">Define audiences (students, faculty, alumni, industry, regulators), key messages, channels, cadence, owners, and notes.</p>
      </div>
      <table class="table" id="commTable">
        <thead>
          <tr>
            <th>Audience</th><th>Message</th><th>Channel</th><th>Cadence</th><th>Owner</th><th>Notes</th><th></th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn" id="addComm">+ Add Audience</button>
        <button class="btn primary" data-export="comm">Export CSV</button>
        <button class="btn" data-print="comm">Print</button>
      </div>
    </div>
  </div>
</section>

<!-- ACTION TRACKER -->
<section id="actions" class="section">
  <div class="container">
    <div class="stack">
      <div class="card">
        <p class="eyebrow">Execution</p>
        <h2 style="margin:0 0 6px">Action Tracker (Backlog → Doing → Done)</h2>
        <p class="lead">Lightweight Kanban to move decisions into action. Keep items small, assign a single owner, and limit “Doing”.</p>
      </div>
      <div class="grid cols-3" id="kanban">
        <div class="card">
          <h3>Backlog</h3>
          <ul id="todo" class="stack"></ul>
          <div class="row">
            <input id="todoInput" type="text" placeholder="Add task">
            <button class="btn" data-add="todo">Add</button>
          </div>
        </div>
        <div class="card">
          <h3>Doing</h3>
          <ul id="doing" class="stack"></ul>
          <div class="row">
            <input id="doingInput" type="text" placeholder="Add task">
            <button class="btn" data-add="doing">Add</button>
          </div>
        </div>
        <div class="card">
          <h3>Done</h3>
          <ul id="done" class="stack"></ul>
          <div class="row">
            <input id="doneInput" type="text" placeholder="Add task">
            <button class="btn" data-add="done">Add</button>
          </div>
        </div>
      </div>
      <div class="row" style="gap:8px; flex-wrap:wrap">
        <button class="btn primary" data-export="kanban">Export JSON</button>
        <button class="btn" data-print="kanban">Print</button>
      </div>
    </div>
  </div>
</section>

<footer class="section" style="padding:24px 0">
  <div class="container">
    <div class="stack">
      <div class="card">
        <b>Privacy</b>: All data stays in your browser via <span class="mono">localStorage</span>. Use Import/Export to move between devices.
      </div>
      <div>
        Copyright © 2025 Shunya Publications. All rights reserved.<br/>
        For rights, permissions, and inquiries, please contact:
        <a href="mailto:editor@shunyapublications.com">editor@shunyapublications.com</a>
      </div>
    </div>
  </div>
</footer>

<script>
/* ========= Utilities & State ========= */
const $ = (sel, root=document)=>root.querySelector(sel);
const $$ = (sel, root=document)=>Array.from(root.querySelectorAll(sel));
const KEY = 'leadership.app.v3_4'; // versioned localStorage key
const state = JSON.parse(localStorage.getItem(KEY) || '{}');

function save() {
  state._updatedAt = new Date().toISOString();
  localStorage.setItem(KEY, JSON.stringify(state));
  const t1 = $('#lastSave'); if (t1) { try { t1.textContent = new Date(state._updatedAt).toLocaleString(); } catch {} }
  const t2 = $('#lastSave2'); if (t2) { try { t2.textContent = new Date(state._updatedAt).toLocaleString(); } catch {} }
}
function loadField(id, fallback=''){ const v = (state[id] ?? fallback); const el = $('#'+id); if(el) el.value = v; }
function bindField(id){ const el = $('#'+id); if(!el) return; el.addEventListener('input', ()=>{ state[id]=el.value; save(); }); }
function downloadBlob(data, name, type='application/json'){
  const blob = new Blob([data], {type}); const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href = url; a.download = name; a.click();
  setTimeout(()=>URL.revokeObjectURL(url), 300);
}
function toCSV(rows, headers){
  const esc = s => `"${String(s??'').replace(/"/g,'""').replace(/\n/g,' ')}"`; const head = headers.map(esc).join(',');
  const body = rows.map(r=>headers.map(h=>esc(r[h])).join(',')).join('\n');
  return head + '\n' + body;
}
function escapeHTML(s){ return String(s).replace(/[&<>]/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;'}[c])); }

/* ========= Leadership PDF Link ========= */
loadField('pdfLink','/leadership.pdf'); bindField('pdfLink');
$('#open-pdf').addEventListener('click', ()=> {
  const url = ($('#pdfLink').value || '/leadership.pdf').trim();
  $('#open-pdf').setAttribute('href', url);
});

/* ========= Org identity (logo + name) ========= */
loadField('orgName',''); bindField('orgName');
  // --- Show Institution Name in the right caption ---
function updateInstNameCaption(){
  const name = (state.orgName || '').trim();
  const cap  = $('#instHeroCaption');
  if (!cap) return;

  // If a name is set, show it; otherwise keep a helpful default
  cap.textContent = name || (state.instImageDataUrl
    ? 'Institution cover image (you can replace it anytime).'
    : 'Upload an institution cover image (right here) using the field in the left card.');
}
// run once on load and whenever the name changes
updateInstNameCaption();
$('#orgName').addEventListener('input', updateInstNameCaption);

const orgLogoInp = $('#orgLogo');
if(state.orgLogoDataUrl && orgLogoInp){ orgLogoInp.dataset.hasImage = '1'; }
if(orgLogoInp){
  orgLogoInp.addEventListener('change', async (e)=>{
    const f = e.target.files && e.target.files[0]; if(!f) return;
    const reader = new FileReader();
    reader.onload = () => { state.orgLogoDataUrl = reader.result; save(); alert('Logo saved for prints.'); };
    reader.readAsDataURL(f);
  });
}

/* ========= Institution cover image (right preview) ========= */
const instImageInp = $('#instImage');
const instPreview = $('#instHeroPreview');
const instCaption = $('#instHeroCaption');

function applyInstPreview(){
  if(state.instImageDataUrl){
    instPreview.src = state.instImageDataUrl;
    instPreview.style.display = 'inline-block';
    if(instCaption) instCaption.textContent = 'Institution cover image (you can replace it anytime).';
  }else{
    instPreview.removeAttribute('src');
    instPreview.style.display = 'none';
    if(instCaption) instCaption.textContent = 'Upload an institution cover image (right here) using the field in the left card.';
  }
}
if(instImageInp){
  instImageInp.addEventListener('change', async (e)=>{
    const f = e.target.files && e.target.files[0]; if(!f) return;
    const reader = new FileReader();
    reader.onload = () => { state.instImageDataUrl = reader.result; save(); applyInstPreview(); };
    reader.readAsDataURL(f);
  });
   if(state.instImageDataUrl){
    instPreview.src = state.instImageDataUrl;
    instPreview.style.display = 'inline-block';
  } else {
    instPreview.removeAttribute('src');
    instPreview.style.display = 'none';
  }
  // keep the caption in sync with name/image state
  updateInstNameCaption();
}
applyInstPreview();

/* ========= KPI Dashboard ========= */
const defaultKPIs = [
  {name:'Research Output (yr)', value:'—', status:'ok'},
  {name:'Patents (yr)', value:'—', status:'warn'},
  {name:'Consultancy ₹ (yr)', value:'—', status:'risk'},
  {name:'Placement %', value:'—', status:'warn'},
  {name:'Median CTC ₹', value:'—', status:'ok'},
  {name:'NAAC Grade', value:'A+', status:'ok'},
  {name:'NIRF Rank Band', value:'200', status:'warn'},
  {name:'OBE Mapping %', value:'80', status:'risk'}
];
function ensureKpis(){ if(!Array.isArray(state.kpis) || !state.kpis.length){ state.kpis = JSON.parse(JSON.stringify(defaultKPIs)); save(); } }
function kpiBadgeClass(s){ return s==='risk'?'status-risk':(s==='warn'?'status-warn':'status-ok'); }
function renderKPIs(){
  ensureKpis();
  const grid = $('#kpiGrid'); grid.innerHTML='';
  state.kpis.forEach((kpi, idx)=>{
    const card = document.createElement('div'); card.className='kpi'; card.dataset.idx = String(idx);
    card.innerHTML = `
      <div class="row">
        <div class="w-66"><input type="text" class="kpi-name" value="${kpi.name||''}" placeholder="KPI name"></div>
        <div class="w-25"><input type="text" class="kpi-value" value="${kpi.value||''}" placeholder="Value"></div>
        <div class="w-25">
          <select class="kpi-status">
            <option value="ok" ${kpi.status==='ok'?'selected':''}>OK</option>
            <option value="warn" ${kpi.status==='warn'?'selected':''}>Watch</option>
            <option value="risk" ${kpi.status==='risk'?'selected':''}>Risk</option>
          </select>
        </div>
      </div>
      <div class="row">
        <span class="badge ${kpiBadgeClass(kpi.status)} kpi-badge">${(kpi.status||'OK').toUpperCase()}</span>
        <button class="btn danger" title="Delete KPI">Delete</button>
      </div>
    `;
    grid.appendChild(card);
  });
}
renderKPIs();
$('#kpiGrid').addEventListener('input', (e)=>{
  const card = e.target.closest('.kpi'); if(!card) return;
  const idx = +card.dataset.idx; if(isNaN(idx)) return;
  const nameEl = card.querySelector('.kpi-name');
  const valueEl = card.querySelector('.kpi-value');
  const statusEl = card.querySelector('.kpi-status');
  state.kpis[idx].name = nameEl.value;
  state.kpis[idx].value = valueEl.value;
  state.kpis[idx].status = statusEl.value;
  save();
  const badge = card.querySelector('.kpi-badge');
  badge.textContent = (statusEl.value||'OK').toUpperCase();
  badge.className = 'badge kpi-badge ' + kpiBadgeClass(statusEl.value);
});
$('#kpiGrid').addEventListener('click', (e)=>{
  const btn = e.target.closest('.btn.danger'); if(!btn) return;
  const card = btn.closest('.kpi'); const idx = +card.dataset.idx;
  if(isNaN(idx)) return;
  state.kpis.splice(idx,1); save(); renderKPIs();
});
$('#addKPI').addEventListener('click', ()=>{ ensureKpis(); state.kpis.push({name:'New KPI', value:'0', status:'warn'}); save(); renderKPIs(); });

/* ========= Dynamic Table helpers ========= */
function addRow(tableId, obj){
  const tb = $('#'+tableId+' tbody');
  const tr = document.createElement('tr');
  const cols = {
    naac:['crit','artifact','owner','link','status','notes'],
    nirf:['cat','ind','val','year','src','notes'],
    comp:['item','body','date','owner','status','notes'],
    gov:['body','cadence','quorum','decision','evid','owner'],
    iqac:['art','type','prog','link','owner','ver'],
    proj:['name','owner','start','end','status','mile'],
    obe:['course','pos','cos','assess','evid','owner'],
    rs:['type','title','venue','value','year','evid'],
    mou:['type','partner','value','start','end','evid'],
    fw:['name','teach','res','adm','fdp','notes'],
    stu:['prog','place','ctc','intern','mooc','notes'],
    risk:['risk','like','imp','mit','owner','status'],
    bud:['item','type','amt','src','year','owner'],
    comm:['aud','msg','chan','cad','owner','notes']
  }[tableId.replace('Table','')];

  cols.forEach((c)=>{
    const td=document.createElement('td');
    const isDate = ['start','end','date'].includes(c);
    const isNum = ['amt','val','year','place','ctc','intern'].includes(c);
    const isLong = ['notes','mile','msg','decision'].includes(c);
    const inp = document.createElement(isLong?'textarea':'input');
    if(isDate){ inp.type='date'; }
    else if(isNum){ inp.type='number'; inp.step='any'; }
    else { inp.type = 'text'; }
    inp.value = (obj && obj[c]) || '';
    inp.addEventListener('input', ()=>{ syncTableState(tableId); });
    td.appendChild(inp); tr.appendChild(td);
  });
  const tdDel=document.createElement('td');
  const btn=document.createElement('button'); btn.className='btn danger'; btn.textContent='Delete';
  btn.addEventListener('click', ()=>{ tr.remove(); syncTableState(tableId); });
  tdDel.appendChild(btn); tr.appendChild(tdDel);
  tb.appendChild(tr);
  syncTableState(tableId);
}
function getTableRows(tableId){
  const headers = {
    naac:['crit','artifact','owner','link','status','notes'],
    nirf:['cat','ind','val','year','src','notes'],
    comp:['item','body','date','owner','status','notes'],
    gov:['body','cadence','quorum','decision','evid','owner'],
    iqac:['art','type','prog','link','owner','ver'],
    proj:['name','owner','start','end','status','mile'],
    obe:['course','pos','cos','assess','evid','owner'],
    rs:['type','title','venue','value','year','evid'],
    mou:['type','partner','value','start','end','evid'],
    fw:['name','teach','res','adm','fdp','notes'],
    stu:['prog','place','ctc','intern','mooc','notes'],
    risk:['risk','like','imp','mit','owner','status'],
    bud:['item','type','amt','src','year','owner'],
    comm:['aud','msg','chan','cad','owner','notes']
  }[tableId.replace('Table','')];
  const rows=[];
  $$('#'+tableId+' tbody tr').forEach(tr=>{
    const cells = tr.querySelectorAll('td'); const obj={};
    headers.forEach((h,i)=>{ obj[h] = cells[i]?.querySelector('input,textarea')?.value ?? ''; });
    rows.push(obj);
  });
  return rows;
}
function syncTableState(tableId){
  const key = tableId.replace('Table','');
  state[key] = getTableRows(tableId); save();
}
function renderTable(tableId, data){
  const tb = $('#'+tableId+' tbody'); tb.innerHTML='';
  (data||[]).forEach(obj=>addRow(tableId,obj));
}

/* ========= Initialize tables ========= */
[
  'naacTable','nirfTable','compTable','govTable','iqacTable','projTable',
  'obeTable','rsTable','mouTable','fwTable','stuTable','riskTable','budTable','commTable'
].forEach(id=> renderTable(id, state[id.replace('Table','')] || []));

/* ========= Minutes binding ========= */
['mt-title','mt-date','mt-att','mt-agenda','mt-decisions','mt-actions'].forEach(id=>{ loadField(id,''); bindField(id); });

/* ========= Strategic planning bindings ========= */
['sp-vision','sp-mission','sp-goals','sp-kpis','sp-initiatives','sp-alignment','sp-policies'].forEach(id=>{ loadField(id,''); bindField(id); });

/* ========= Add-row buttons ========= */
$('#addNaac').addEventListener('click', ()=>addRow('naacTable'));
$('#addNirf').addEventListener('click', ()=>addRow('nirfTable'));
$('#addComp').addEventListener('click', ()=>addRow('compTable'));
$('#addGov').addEventListener('click', ()=>addRow('govTable'));
$('#addIqac').addEventListener('click', ()=>addRow('iqacTable'));
$('#addProj').addEventListener('click', ()=>addRow('projTable'));
$('#addObe').addEventListener('click', ()=>addRow('obeTable'));
$('#addRs').addEventListener('click', ()=>addRow('rsTable'));
$('#addMou').addEventListener('click', ()=>addRow('mouTable'));
$('#addFw').addEventListener('click', ()=>addRow('fwTable'));
$('#addStu').addEventListener('click', ()=>addRow('stuTable'));
$('#addRisk').addEventListener('click', ()=>addRow('riskTable'));
$('#addBud').addEventListener('click', ()=>addRow('budTable'));
$('#addComm').addEventListener('click', ()=>addRow('commTable'));

/* ========= Per-tool Export/Print ========= */
document.body.addEventListener('click', (e)=>{
  const btn = e.target.closest('button'); if(!btn) return;

  // EXPORTS
  if(btn.dataset.export){
    const id = btn.dataset.export;

    if(id==='kpi'){
      const rows = (state.kpis||[]).map(x=>({name:x.name,value:x.value,status:x.status}));
      const csv = toCSV(rows, ['name','value','status']);
      downloadBlob(csv, 'kpis.csv','text/csv'); return;
    }

    if(id==='sp'){
      const obj = {
        vision: $('#sp-vision').value,
        mission: $('#sp-mission').value,
        goals: $('#sp-goals').value,
        kpis: $('#sp-kpis').value,
        initiatives: $('#sp-initiatives').value,
        alignment: $('#sp-alignment').value,
        policies: $('#sp-policies').value
      };
      downloadBlob(JSON.stringify(obj,null,2),'strategic-planning.json'); return;
    }

    if(id==='mt'){
      const headerName = (state.orgName || '').trim();
      const txt =
`${headerName ? 'Organization: '+headerName+'\n' : ''}${state._updatedAt ? 'Generated: '+new Date(state._updatedAt).toLocaleString()+'\n' : ''}
Minutes: ${$('#mt-title').value}
Date: ${$('#mt-date').value}
Attendees: ${$('#mt-att').value}

Agenda:
${$('#mt-agenda').value}

Decisions:
${$('#mt-decisions').value}

Action Items:
${$('#mt-actions').value}
`;
      downloadBlob(txt,'minutes.txt','text/plain'); return;
    }

    if(id==='kanban'){
      const obj = { todo: state.todo||[], doing: state.doing||[], done: state.done||[] };
      downloadBlob(JSON.stringify(obj,null,2),'kanban.json'); return;
    }

    // generic table CSV
    const map = {
      naac:'naacTable', nirf:'nirfTable', comp:'compTable', gov:'govTable',
      iqac:'iqacTable', proj:'projTable', obe:'obeTable', rs:'rsTable',
      mou:'mouTable', fw:'fwTable', stu:'stuTable', risk:'riskTable',
      bud:'budTable', comm:'commTable'
    };
    if(map[id]){
      const rows = getTableRows(map[id]);
      const headers = Object.keys(rows[0]||{col1:'',col2:''});
      const csv = toCSV(rows, headers);
      downloadBlob(csv, id+'.csv','text/csv'); return;
    }
  }

  // PRINTS
  if(btn.dataset.print){
    const id = btn.dataset.print;
    let node;

    if(id==='kpi'){ node = $('#kpiGrid'); }
    else if(id==='sp'){ node = $('#planning'); }
    else if(id==='kanban'){ node = $('#kanban'); }
    else if(id==='mt'){
      const wrap = document.createElement('div');
      wrap.innerHTML = `
        ${printHeaderHTML()}
        <h1 style="margin:.2rem 0 8px">Meeting Minutes</h1>
        <p><b>Title:</b> ${escapeHTML($('#mt-title').value || '—')}</p>
        <p><b>Date:</b> ${escapeHTML($('#mt-date').value || '—')}</p>
        <p><b>Attendees:</b> ${escapeHTML($('#mt-att').value || '—')}</p>
        <h3>Agenda</h3><pre>${escapeHTML($('#mt-agenda').value || '')}</pre>
        <h3>Decisions</h3><pre>${escapeHTML($('#mt-decisions').value || '')}</pre>
        <h3>Action Items</h3><pre>${escapeHTML($('#mt-actions').value || '')}</pre>
      `;
      printNode(wrap); return;
    }
    else {
      const map = {
        naac:'naacTable', nirf:'nirfTable', comp:'compTable', gov:'govTable',
        iqac:'iqacTable', proj:'projTable', obe:'obeTable', rs:'rsTable',
        mou:'mouTable', fw:'fwTable', stu:'stuTable', risk:'riskTable',
        bud:'budTable', comm:'commTable'
      };
      node = document.createElement('div');
      node.innerHTML = `${printHeaderHTML()}${$('#'+map[id]).outerHTML}`;
    }
    if(node) printNode(node);
  }
});

/* ========= Print helpers with logo/name header ========= */
function printHeaderHTML(){
  const name = escapeHTML(state.orgName || '');
  const hasLogo = !!state.orgLogoDataUrl;
  return `
    <div style="display:flex;align-items:center;gap:12px;margin-bottom:12px">
      ${hasLogo ? `<img src="${state.orgLogoDataUrl}" alt="Logo" style="height:48px;width:auto;border-radius:6px;border:1px solid #cfd8e6">` : ''}
      <div>
        <div style="font-weight:800;font-size:18px">${name || 'Organization'}</div>
        <div style="font-size:12px;color:#5a6b88">Generated: ${new Date().toLocaleString()}</div>
      </div>
    </div>
    <hr style="border:none;border-top:1px solid #cfd8e6;margin:8px 0 14px">
  `;
}
function printNode(node){
  const w=window.open('','_blank','width=1024,height=800');
  w.document.write(`<!doctype html><html><head><meta charset="utf-8"><title>Print</title>
  <style>
  body{font-family:${getComputedStyle(document.body).fontFamily};margin:16px;color:#142036}
  table{width:100%;border-collapse:separate;border-spacing:0 6px}
  td,th{border:1px solid #cfd8e6;padding:6px;border-radius:8px}
  h1,h2,h3{margin:.4rem 0}
  pre{white-space:pre-wrap;background:#f7fbff;border:1px solid #dbe7ff;padding:10px;border-radius:8px}
  img{max-width:180px}
  </style></head><body>${node.outerHTML}</body></html>`);
  w.document.close(); w.focus(); w.print();
}

/* ========= Kanban ========= */
function renderKanban(){
  ['todo','doing','done'].forEach(col=>{
    const ul = $('#'+col); ul.innerHTML='';
    (state[col]||[]).forEach((t,i)=>{
      const li=document.createElement('li'); li.className='card';
      li.innerHTML = `<div>${escapeHTML(t)}</div>`;
      const bar=document.createElement('div'); bar.className='row';
      ['todo','doing','done'].forEach(target=>{
        if(target!==col){
          const b=document.createElement('button'); b.className='btn'; b.textContent='→ '+target;
          b.addEventListener('click',()=> moveTask(col, target, i));
          bar.appendChild(b);
        }
      });
      const del=document.createElement('button'); del.className='btn danger'; del.textContent='Delete';
      del.addEventListener('click',()=> removeTask(col, i));
      bar.appendChild(del);
      li.appendChild(bar); ul.appendChild(li);
    });
  });
}
function addTask(col, text){
  state[col]=state[col]||[]; if(String(text||'').trim()){ state[col].push(text.trim()); save(); renderKanban(); }
}
function moveTask(from,to,idx){
  state[from]=state[from]||[]; state[to]=state[to]||[];
  const [t]=state[from].splice(idx,1); if(t!==undefined){ state[to].push(t); } save(); renderKanban();
}
function removeTask(col, idx){ state[col].splice(idx,1); save(); renderKanban(); }
$$('[data-add]').forEach(btn=>{
  btn.addEventListener('click',()=>{ const col = btn.dataset.add; const val = $('#'+col+'Input').value; addTask(col,val); $('#'+col+'Input').value=''; });
});
renderKanban();

/* ========= Global Import/Export/Reset ========= */
$('#global-export-json').addEventListener('click',()=>{ downloadBlob(JSON.stringify(state,null,2),'leadership-toolkit.json'); });
$('#global-import-json').addEventListener('click',()=>{
  const inp=document.createElement('input'); inp.type='file'; inp.accept='application/json';
  inp.onchange=async ()=>{ const file=inp.files[0]; if(!file) return; const text=await file.text();
    try{ const obj=JSON.parse(text); localStorage.setItem(KEY, JSON.stringify(obj)); location.reload(); }
    catch(e){ alert('Invalid JSON'); }
  };
  inp.click();
});
$('#global-export-csv').addEventListener('click',()=>{
  const packs = {
    kpis:(state.kpis||[]).map(x=>({name:x.name,value:x.value,status:x.status})),
    naac:(state.naac||[]), nirf:(state.nirf||[]), comp:(state.comp||[]),
    gov:(state.gov||[]), iqac:(state.iqac||[]), proj:(state.proj||[]),
    obe:(state.obe||[]), rs:(state.rs||[]), mou:(state.mou||[]),
    fw:(state.fw||[]), stu:(state.stu||[]), risk:(state.risk||[]),
    bud:(state.bud||[]), comm:(state.comm||[])
  };
  Object.entries(packs).forEach(([k,rows])=>{
    const headers = Object.keys(rows[0]||{col1:'',col2:''});
    const csv = toCSV(rows, headers);
    downloadBlob(csv, `export-${k}.csv`, 'text/csv');
  });
});
$('#global-reset').addEventListener('click',()=>{ if(confirm('Reset ALL toolkit data on this device?')){ localStorage.removeItem(KEY); location.reload(); }});

/* ========= Last save labels ========= */
const firstSave = state._updatedAt ? new Date(state._updatedAt).toLocaleString() : '—';
if($('#lastSave')) $('#lastSave').textContent = firstSave;
if($('#lastSave2')) $('#lastSave2').textContent = firstSave;
</script>
</body>
</html>
